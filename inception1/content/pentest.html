<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<META http-equiv="Content-Type" content="text/html; charset=windows-1251">
		<link rel="stylesheet" type="text/css" href="style/style.css">
		<title> Web security assessment planning </title>
	</head>

	<body>
	<table cellpadding="25" align="center" >
			<tr>
				<td>
					<h2><span class="header">Web security assessment planning</span></h2>
					<br>
					<h3><span class="warning">Introduction.</span></h3>
					<p class="text">These notes are sort of logical progression of my late article <span class="warning">"Non-intrusive critical data collection" (1)</span>, 
published at <span class="warning">bugtraq.ru</span>, 2003 and then to Belorussian print mag <span class="warning">"Networked Solutions".</span>.</p> 
					<p class="text">This is a specific material not intended for general readership due to low interest in subject matter.
Though, this may be useful for professionals assessing web security on a regular basis. Techiques introduced
could aid in structuring collected data and site-specific info, as well as building a step-by-step checklist for
security testing.</p> 
					<p class="text">Order of actions and storing data is chosen by author's personal preferences (largely influenced by
<span class="warning">OWASP(2)</span> guides). Any practitioner may, and likely will, use his own set of techniques and way of storing gathered data.
Many of online services metioned aren't unique and someone would better code his own or use other similar services.</p>
					<p class="text">Notes on <span class="warning">OWASP Testing Guide</span>: as of current, official site offers v.3 (349 pages) but earlier it has some 
					<span class="warning">OWASP_Testing_Guide_v3.full.pdf</span> (374 pages). Considering the guide's cons, it's somewhat redundant and some of
scenarios covered seems to be less likely to actually happen, or very rare to meet.</p>
					<p class="text">Nethertheless, advice on organized testing and risk classification system are actually useful. Other guides worth
mentioning are <span class="warning">Information Technology Security Evaluation and OSSTMM (Open Source 
Security Testing Methodology Manual).</span></p>
					<p class="text">Resources chosen for demonstration purposes are of some non-compliant service center that breaks customer's devices 
instead of repairing.</p><br>
					
					<h3><span class="warning">Analysis order.</span></h3>
					<p class="text">I use Excel sheets from crafted template to store data collected through the testing. The template includes 
custom codes for every data type, showing what data was gathered by which action. It also has a check-mark cell
to ensure every test was made. Next cell is for actual data (and code). It looks like this:</p>

<PRE>
__________________________________________________
[RDNS] | Reverse DNS | x | (Reverse DNS data here)
--------------------------------------------------
</PRE>

					<p class="text">First step is to <span class="warning">gather basic resource identifying data</span> like IP, ISP, web server type. 
I choose combined (ping, DNS, traceroute, basic service scan) service <span class="warning">Domain Dossier(3)</span>.
Firefox addon Server Spy aids web server fingerprinting too.</p>

<PRE>
simservice.ru    = 213.189.197.165 (axx165.distributed.zenon.net)
samsungremont.ru = 89.111.176.12   (fe16.hc.ru)
</PRE>

					<p class="text">Both sites located on shared hostings <span class="warning">"Zenon"</span> è <span class="warning">"Hosting-Center"</span>,  
					using nginx and <span class="warning">OSCommerce</span> shop engine.
<span class="warning">simservice.ru</span> indicates PHP/5.2.17. They also use <span class="warning">livetex.ru</span> online consulting widget.</p>
					<p class="text">To check aforementioned <span class="warning">Reverse DNS</span> i use <span class="warning">Robtex(5) and BGP Looking Glass(6)</span>, 
					thus checking if the hosting is dedicated or shared.</p>
					<p class="text">Next, browsing the site itself, having Firefox addon <span class="warning">Foxmeter(7)</span> enabled - it's a HTTP/HTTPS sniffer,
clearly showing site structure, widgets, server responses. 

To see what HTTP methods are enabled, i send OPTIONS request using Firefox addon <span class="warning">Poster(8)</span> or curl. 
Both sites tested rejected OPTIONS request (nginx style).

It could be helpful to check SSL certificate, if any. Online tool is available at 
<span class="warning">serversniff.net (10). </span>

Some cases show that Google dork <span class="warning">"victim.com" site:victim.com</span> sometimes bring up unexpected results, 
like error and backend pages etc. 
<span class="warning">samsungremont.ru</span> replied to .htaccess request by Apache/1.3.42 403 error page (banner-masquerading).</p>

					<p class="text">At this stage it's possible to get the picture of the web server and DNS.

Additional data could be found in common files <span class="warning">robots.txt and sitemap.xml (sitemap.xml.gz). </span>
If there's no sitemap.xml, it could be <span class="warning">generated online(9)</span> or by a desktop application.
Tested sites has default OSCommerce robots.txt, and the sitemap.xml was generated online.

Identifying web designer (a company or an individual) could be useful due to repeated design solutions.
For example, several companies definitely neglect .htaccess, resulting in directory listing (<span class="warning">OWASP-AZ-001</span>)
of all of their productions. 
This case shows both sites were designed by <span class="warning">pella.ru</span> with no critical issues (if we don't count  
<a href="http://samsungremont.ru/includes/sts_templates/sam/images/fon.jpg" target="_blank"> ugly background </a> )</p>
					<p class="text">ISP corporate site often has useful data on security systems deployed, so it's advised to browse.
To exclude repeating this step, a separate sheet is prepared to store data on ISPs: hardware, OS,
IP ranges, special domains for customers).
During the tests for this article it was interesting to find Zenon's modem pool data: <br>
Guest access - demo:demo</p>

<PRE>
745-7171 - Cisco Systems Access Server 5300
251-1030 - USRobotics MP16
</PRE>

					<p class="text">After CMS is fingerprinted fo sure its recommended to get a copy of it. Most cases show that even major 
companies use free CMSes like <span class="warning">Wordpress/Drupal/Joomla!.</span> Non-free engines are could be obtained as trial
versions, allowing to examine the structure and potential security issues. Many engines suffers from bugs
like WordPress listing or Joomla! mandatory registration, enabling some backend fuctionality.</p>
					<p class="text">Next step is to identify data storage path and backend login interface. Accessible administrative 
interface classified as risk <span class="warning">OWASP-CM-007.</span> 
Test shows both sites' administrative interface located at /admin.</p>
					<p class="text">Any server response could bring some critical data like logins and error messages. 
Sometimes even cookies hold useful data that adds to server analysis. 
Cookies from tested sites are default OSCommerce and livetex. 

Internal search engine is a way to gather more data, and any form is a potential attack vector. 
<a href="http://samsungremont.ru/advanced_search.php" target="_blank">Search engine discovered</a>.</p>
					<p class="text">Concluding, let's recall basic data types gathered by aforementioned tests:
IP, DNS records, web server and CMS fingerprints, a CMS copy, site structure, allowed HTTP methods,
service files like robots.txt and sitemap.xml, ISP and designer identifications, data storage and 
administrative iterface paths. Resulting sheet will look like this:</p>

<PRE>
_______________________________________________________________________________________________
CENTRALOPS   | + |
REVERSE DNS  | + | shared
HTTP SNIFF   | + | CMS
HTTP OPTIONS | + | -
SERVER       | + | nginx 1.4.1
ISP          | + | 213.189.197.165 (axx165.distributed.zenon.net) / 89.111.176.12 (fe16.hc.ru)
SHARED       | + | +
CMS          | + | OSCommerce
SOURCE COPY  | + | +
HTML CHECK   | + | +
ADMIN        | + | /admin
SEARCH       | + | http://samsungremont.ru/advanced_search.php
ERRORS       | + | +
ROBOTS       | + | +
SITEMAP      | + | generic
HTACCESS     | + | 403
COOKIES      | + | +
</PRE>

					<br>
					<p class="warning">Links:</p>
					<ul>
						<li>(1) <a href="http://www.bugtraq.ru/library/security/nonintrusive.html" target="_blank">http://www.bugtraq.ru/library/security/nonintrusive.html</a></li>
						<li>(2) <a href="https://www.owasp.org" target="_blank">https://www.owasp.org</a></li>
						<li>(3) <a href="http://centralops.net/co/DomainDossier.aspx" target="_blank">http://centralops.net/co/DomainDossier.aspx</a></li>
						<li>(4) <a href="https://addons.mozilla.org/ru/firefox/addon/server-spy/" target="_blank">https://addons.mozilla.org/ru/firefox/addon/server-spy/</a></li>
						<li>(5) <a href="http://www.robtex.com" target="_blank">http://www.robtex.com</a></li>
						<li>(6) <a href="http://bgp.he.net" target="_blank">http://bgp.he.net</a></li>
						<li>(7) <a href="https://addons.mozilla.org/ru/firefox/addon/foxmeter" target="_blank">https://addons.mozilla.org/ru/firefox/addon/foxmeter</a></li>
						<li>(8) <a href="https://addons.mozilla.org/ru/firefox/addon/poster" target="_blank">https://addons.mozilla.org/ru/firefox/addon/poster</a></li>
						<li>(9) <a href="http://www.xml-sitemaps.com" target="_blank">http://www.xml-sitemaps.com</a></li>
						<li>(10) <a href="http://serversniff.net/content.php?do=ssl" target="_blank">http://serversniff.net/content.php?do=ssl</a></li>
					</ul>

<p class="warning"><br>______________________________<br>
ALiEN Assault<br>
2013<br><br>
Inception E-Zine</p>

				</td>
			</tr>
		</table>
	</body>
</html>